[
  {
    "id": "scenario_file_archiving_compression_140",
    "command": "tar",
    "scenario": "Archive and compress files for backup, distribution, and storage efficiency.",
    "problem": "Need to create backups, compress large directories, extract archives, handle different compression formats (gzip, bzip2, xz), preserve file permissions and timestamps, and manage archive contents without full extraction.",
    "solution": "Master tar for archiving, combine with compression tools (gzip, bzip2, xz), use zip for cross-platform compatibility, understand compression tradeoffs, and efficiently manage archive creation, extraction, and inspection.",
    "steps": [
      "USER SAYS: 'How do I create compressed backups of directories? What's the difference between .tar.gz, .tar.bz2, and .zip? How do I extract and inspect archives?'",
      "AGENT: 'Let me show you file archiving and compression! We'll use tar with different compression methods, zip for compatibility, and learn extraction techniques.'",
      "AGENT: ''",
      "AGENT: '🔍 RESEARCH PHASE: File archiving and compression...'",
      "AGENT: '[Searching] \"tar gzip bzip2 xz zip compression archiving\"'",
      "AGENT: '[Found] tar creates archives (multiple files → one file).'",
      "AGENT: '[Found] gzip (.gz) fast, bzip2 (.bz2) better compression, xz (.xz) best compression.'",
      "AGENT: '[Found] tar flags: -c create, -x extract, -t list, -z gzip, -j bzip2, -J xz.'",
      "AGENT: '[Found] zip creates compressed archives compatible with Windows.'",
      "AGENT: '✓ Research complete! Let's archive and compress.'",
      "AGENT: ''",
      "AGENT: '--- Approach 1: Create Basic tar Archive ---'",
      "Create tool: `mkdir -p test-dir/{subdir1,subdir2}`",
      "Create tool: `echo \"file1\" > test-dir/file1.txt`",
      "Create tool: `echo \"file2\" > test-dir/subdir1/file2.txt`",
      "Create tool: `echo \"file3\" > test-dir/subdir2/file3.txt`",
      "AGENT: ''",
      "Run command: `tar -cf archive.tar test-dir/`",
      "AGENT: '  -c = Create archive'",
      "AGENT: '  -f = File name'",
      "AGENT: 'Creates uncompressed tar archive'",
      "AGENT: ''",
      "Run command: `ls -lh archive.tar`",
      "AGENT: '-rw-r--r-- 1 user user 10K Oct  8 10:00 archive.tar'",
      "AGENT: ''",
      "AGENT: '--- Approach 2: Gzip Compression (.tar.gz or .tgz) ---'",
      "Run command: `tar -czf archive.tar.gz test-dir/`",
      "AGENT: '  -z = Compress with gzip'",
      "AGENT: 'Creates gzip-compressed archive'",
      "AGENT: ''",
      "Run command: `ls -lh archive.tar.gz`",
      "AGENT: '-rw-r--r-- 1 user user 2.3K Oct  8 10:00 archive.tar.gz'",
      "AGENT: '✓ Much smaller than uncompressed!'",
      "AGENT: ''",
      "AGENT: 'Alternative: .tgz extension'",
      "Run command: `tar -czf archive.tgz test-dir/`",
      "AGENT: 'Same as .tar.gz'",
      "AGENT: ''",
      "AGENT: '--- Approach 3: Bzip2 Compression (.tar.bz2 or .tbz2) ---'",
      "Run command: `tar -cjf archive.tar.bz2 test-dir/`",
      "AGENT: '  -j = Compress with bzip2'",
      "AGENT: 'Better compression than gzip, but slower'",
      "AGENT: ''",
      "Run command: `ls -lh archive.tar.bz2`",
      "AGENT: '-rw-r--r-- 1 user user 2.1K Oct  8 10:00 archive.tar.bz2'",
      "AGENT: 'Slightly smaller than .tar.gz'",
      "AGENT: ''",
      "AGENT: '--- Approach 4: XZ Compression (.tar.xz) ---'",
      "Run command: `tar -cJf archive.tar.xz test-dir/`",
      "AGENT: '  -J = Compress with xz'",
      "AGENT: 'Best compression, slowest'",
      "AGENT: ''",
      "Run command: `ls -lh archive.tar.xz`",
      "AGENT: '-rw-r--r-- 1 user user 1.8K Oct  8 10:00 archive.tar.xz'",
      "AGENT: 'Smallest file size!'",
      "AGENT: ''",
      "AGENT: '--- Approach 5: Compression Comparison ---'",
      "Run command: `ls -lh archive.*`",
      "AGENT: '-rw-r--r-- 1 user user  10K  archive.tar       (no compression)'",
      "AGENT: '-rw-r--r-- 1 user user 2.3K  archive.tar.gz    (gzip - fast)'",
      "AGENT: '-rw-r--r-- 1 user user 2.1K  archive.tar.bz2   (bzip2 - balanced)'",
      "AGENT: '-rw-r--r-- 1 user user 1.8K  archive.tar.xz    (xz - best)'",
      "AGENT: ''",
      "AGENT: 'When to use:'",
      "AGENT: '  .tar.gz  - General purpose, fast, good compression'",
      "AGENT: '  .tar.bz2 - Better compression, slightly slower'",
      "AGENT: '  .tar.xz  - Best compression, use for long-term storage'",
      "AGENT: '  .tar     - No compression, fastest, use for already-compressed data'",
      "AGENT: ''",
      "AGENT: '--- Approach 6: Extract Archives ---'",
      "Run command: `tar -xzf archive.tar.gz`",
      "AGENT: '  -x = Extract'",
      "AGENT: '  -z = Decompress gzip'",
      "AGENT: 'Extracts to current directory'",
      "AGENT: ''",
      "Run command: `tar -xzf archive.tar.gz -C /tmp/`",
      "AGENT: '  -C = Extract to specific directory'",
      "AGENT: ''",
      "Run command: `tar -xjf archive.tar.bz2`",
      "AGENT: '  -j = Decompress bzip2'",
      "AGENT: ''",
      "Run command: `tar -xJf archive.tar.xz`",
      "AGENT: '  -J = Decompress xz'",
      "AGENT: ''",
      "AGENT: 'Modern tar auto-detects compression:'",
      "Run command: `tar -xf archive.tar.gz`",
      "AGENT: 'Works without -z! Tar detects gzip automatically'",
      "AGENT: ''",
      "AGENT: '--- Approach 7: List Archive Contents ---'",
      "Run command: `tar -tzf archive.tar.gz`",
      "AGENT: '  -t = List contents'",
      "AGENT: 'test-dir/'",
      "AGENT: 'test-dir/file1.txt'",
      "AGENT: 'test-dir/subdir1/'",
      "AGENT: 'test-dir/subdir1/file2.txt'",
      "AGENT: 'test-dir/subdir2/'",
      "AGENT: 'test-dir/subdir2/file3.txt'",
      "AGENT: ''",
      "Run command: `tar -tzf archive.tar.gz | grep \"file2\"`",
      "AGENT: 'test-dir/subdir1/file2.txt'",
      "AGENT: 'Find specific files in archive'",
      "AGENT: ''",
      "AGENT: '--- Approach 8: Extract Specific Files ---'",
      "Run command: `tar -xzf archive.tar.gz test-dir/file1.txt`",
      "AGENT: 'Extracts only file1.txt (and its path)'",
      "AGENT: ''",
      "Run command: `tar -xzf archive.tar.gz test-dir/subdir1/`",
      "AGENT: 'Extracts only subdir1 and its contents'",
      "AGENT: ''",
      "Run command: `tar -xzf archive.tar.gz --wildcards '*.txt'`",
      "AGENT: 'Extracts all .txt files'",
      "AGENT: ''",
      "AGENT: '--- Approach 9: Verbose and Progress ---'",
      "Run command: `tar -czvf archive.tar.gz test-dir/`",
      "AGENT: '  -v = Verbose (show files being archived)'",
      "AGENT: 'test-dir/'",
      "AGENT: 'test-dir/file1.txt'",
      "AGENT: 'test-dir/subdir1/'",
      "AGENT: 'test-dir/subdir1/file2.txt'",
      "AGENT: '...'",
      "AGENT: ''",
      "Run command: `tar -czf archive.tar.gz test-dir/ --checkpoint=100 --checkpoint-action=echo='%T'`",
      "AGENT: 'Shows progress every 100 files'",
      "AGENT: ''",
      "AGENT: '--- Approach 10: Zip Archives (Cross-Platform) ---'",
      "Run command: `zip -r archive.zip test-dir/`",
      "AGENT: '  -r = Recursive'",
      "AGENT: 'Creates zip archive (compatible with Windows)'",
      "AGENT: ''",
      "Run command: `unzip archive.zip`",
      "AGENT: 'Extracts zip archive'",
      "AGENT: ''",
      "Run command: `unzip -l archive.zip`",
      "AGENT: '  -l = List contents'",
      "AGENT: ''",
      "Run command: `unzip archive.zip -d /tmp/`",
      "AGENT: '  -d = Destination directory'",
      "AGENT: ''",
      "Run command: `unzip archive.zip test-dir/file1.txt`",
      "AGENT: 'Extract specific file'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Exclude Files from Archive ---'",
      "Run command: `tar -czf archive.tar.gz test-dir/ --exclude='*.log' --exclude='*.tmp'`",
      "AGENT: 'Excludes .log and .tmp files'",
      "AGENT: ''",
      "Run command: `tar -czf archive.tar.gz test-dir/ --exclude='test-dir/subdir1'`",
      "AGENT: 'Excludes entire subdirectory'",
      "AGENT: ''",
      "Run command: `tar -czf archive.tar.gz test-dir/ --exclude-vcs`",
      "AGENT: 'Excludes version control dirs (.git, .svn, etc.)'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Preserve Permissions and Ownership ---'",
      "Run command: `sudo tar -czpf archive.tar.gz test-dir/`",
      "AGENT: '  -p = Preserve permissions'",
      "AGENT: 'Keeps original file permissions and ownership'",
      "AGENT: ''",
      "Run command: `sudo tar -xzpf archive.tar.gz`",
      "AGENT: 'Restores original permissions'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Add Files to Existing Archive ---'",
      "Run command: `tar -rf archive.tar newfile.txt`",
      "AGENT: '  -r = Append to archive'",
      "AGENT: '⚠️ Only works with uncompressed .tar!'",
      "AGENT: ''",
      "AGENT: 'For compressed archives, extract, add, re-compress:'",
      "Run command: `gunzip archive.tar.gz`",
      "Run command: `tar -rf archive.tar newfile.txt`",
      "Run command: `gzip archive.tar`",
      "AGENT: ''",
      "AGENT: '--- Bonus: Pipe Archives Over Network ---'",
      "Run command: `tar -czf - test-dir/ | ssh user@remote 'cat > backup.tar.gz'`",
      "AGENT: 'Creates archive and sends to remote server'",
      "AGENT: '  - = stdout'",
      "AGENT: ''",
      "Run command: `ssh user@remote 'tar -czf - /var/www' | tar -xzf -`",
      "AGENT: 'Downloads and extracts remote directory'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Backup Script with Date ---'",
      "Create tool: `cat > backup.sh << 'EOF'`",
      "#!/bin/bash\nset -euo pipefail\n\nSOURCE_DIR=\"${1:-/var/www/html}\"\nBACKUP_DIR=\"${2:-/backup}\"\nDATE=$(date +\"%Y%m%d_%H%M%S\")\nBACKUP_FILE=\"$BACKUP_DIR/backup_${DATE}.tar.gz\"\n\necho \"Creating backup of $SOURCE_DIR...\"\n\nmkdir -p \"$BACKUP_DIR\"\n\ntar -czf \"$BACKUP_FILE\" \\\n    --exclude='*.log' \\\n    --exclude='*.tmp' \\\n    --exclude='cache/*' \\\n    \"$SOURCE_DIR\"\n\nif [ -f \"$BACKUP_FILE\" ]; then\n    SIZE=$(du -h \"$BACKUP_FILE\" | cut -f1)\n    echo \"✓ Backup created: $BACKUP_FILE ($SIZE)\"\n    \n    # Keep only last 7 backups\n    ls -t \"$BACKUP_DIR\"/backup_*.tar.gz | tail -n +8 | xargs -r rm -f\n    echo \"✓ Old backups cleaned (keeping 7 most recent)\"\nelse\n    echo \"✗ Backup failed\" >&2\n    exit 1\nfi\nEOF",
      "Run command: `chmod +x backup.sh`",
      "Run command: `./backup.sh /var/www/html /backup`",
      "AGENT: 'Creating backup of /var/www/html...'",
      "AGENT: '✓ Backup created: /backup/backup_20251008_103000.tar.gz (15M)'",
      "AGENT: '✓ Old backups cleaned (keeping 7 most recent)'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Quick Reference ---'",
      "AGENT: ''",
      "AGENT: 'Create archives:'",
      "AGENT: '  tar -czf file.tar.gz dir/   # gzip'",
      "AGENT: '  tar -cjf file.tar.bz2 dir/  # bzip2'",
      "AGENT: '  tar -cJf file.tar.xz dir/   # xz'",
      "AGENT: '  zip -r file.zip dir/        # zip'",
      "AGENT: ''",
      "AGENT: 'Extract archives:'",
      "AGENT: '  tar -xzf file.tar.gz        # gzip'",
      "AGENT: '  tar -xjf file.tar.bz2       # bzip2'",
      "AGENT: '  tar -xJf file.tar.xz        # xz'",
      "AGENT: '  tar -xf file.tar.gz         # auto-detect'",
      "AGENT: '  unzip file.zip              # zip'",
      "AGENT: ''",
      "AGENT: 'List contents:'",
      "AGENT: '  tar -tzf file.tar.gz'",
      "AGENT: '  unzip -l file.zip'",
      "AGENT: ''",
      "AGENT: 'Common options:'",
      "AGENT: '  -C dir     Extract to directory'",
      "AGENT: '  -v         Verbose output'",
      "AGENT: '  -p         Preserve permissions'",
      "AGENT: '  --exclude  Exclude patterns'",
      "AGENT: ''",
      "AGENT: '✓ SOLUTION SUMMARY:'",
      "AGENT: '  ✓ Created tar archives with -c flag.'",
      "AGENT: '  ✓ Compressed with gzip (-z), bzip2 (-j), xz (-J).'",
      "AGENT: '  ✓ Understood compression tradeoffs: speed vs size.'",
      "AGENT: '  ✓ Extracted archives with -x flag and -C for destination.'",
      "AGENT: '  ✓ Listed archive contents without extracting.'",
      "AGENT: '  ✓ Extracted specific files from archives.'",
      "AGENT: '  ✓ Used zip for cross-platform compatibility.'",
      "AGENT: '  ✓ Excluded files and preserved permissions.'",
      "AGENT: '  ✓ Created automated backup script with rotation.'",
      "AGENT: '  ✓ You now master file archiving and compression! 📦'"
    ],
    "commands": ["tar", "gzip", "bzip2", "xz", "zip", "unzip", "gunzip"],
    "packages": {
      "debian_ubuntu": ["tar", "gzip", "bzip2", "xz-utils", "zip", "unzip"],
      "arch": ["tar", "gzip", "bzip2", "xz", "zip", "unzip"]
    },
    "related_commands": ["7z", "rar", "compress"],
    "complexity": "intermediate",
    "tags": ["tar", "gzip", "bzip2", "xz", "zip", "compression", "archiving", "backup", "extraction"]
  }
]
