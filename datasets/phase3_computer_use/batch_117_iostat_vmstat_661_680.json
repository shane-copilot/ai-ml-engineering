[
  {
    "id": "scenario_iostat_disk_monitoring_128",
    "command": "iostat",
    "scenario": "Monitor disk I/O performance and identify bottlenecks with iostat.",
    "problem": "System experiencing slow disk operations, need to identify which disks have high I/O wait, check read/write speeds, monitor disk utilization, and diagnose storage bottlenecks affecting application performance.",
    "solution": "Use iostat to monitor disk I/O statistics, understand await/svctm metrics, identify bottlenecked devices, analyze read/write patterns, and correlate high I/O wait with system performance issues.",
    "steps": [
      "USER SAYS: 'My applications are slow and I suspect disk I/O is the problem. How do I monitor disk performance and find bottlenecks?'",
      "AGENT: 'Let me show you iostat - the I/O statistics tool! It monitors disk activity, read/write speeds, and helps identify storage bottlenecks.'",
      "AGENT: ''",
      "Run command: `sudo apt install sysstat -y`",
      "Run command: `iostat`",
      "AGENT: 'Linux 6.16.8-arch3-1 (hostname)   10/08/2025'",
      "AGENT: ''",
      "AGENT: 'avg-cpu:  %user   %nice %system %iowait  %steal   %idle'",
      "AGENT: '           15.2    0.0     8.3    12.5     0.0    64.0'",
      "AGENT: ''",
      "AGENT: 'Device    tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn'",
      "AGENT: 'sda     45.23      1234.56       890.12    9876543    7654321'",
      "AGENT: 'sdb    123.45      5678.90      2345.67   45678901   23456789'",
      "AGENT: ''",
      "Run command: `iostat -x 2 5`",
      "AGENT: '  -x = Extended statistics'",
      "AGENT: '  2 = Update every 2 seconds'",
      "AGENT: '  5 = 5 iterations'",
      "AGENT: ''",
      "AGENT: 'Device  r/s  w/s  rkB/s  wkB/s  rrqm/s  wrqm/s  %rrqm  %wrqm  r_await  w_await  aqu-sz  rareq-sz  wareq-sz  svctm  %util'",
      "AGENT: 'sda    12.5  8.3  156.4   98.7    0.2     1.5    1.6    15.3    2.34     3.45    0.05     12.5      11.9     0.8   2.1'",
      "AGENT: 'sdb    89.2 45.6  1234.5  567.8   5.6    12.3    5.9    21.2   15.67    28.93    2.34     13.8      12.4     4.5  85.3  ← High!'",
      "AGENT: ''",
      "AGENT: 'Key metrics:'",
      "AGENT: '  • r/s, w/s = Reads/writes per second'",
      "AGENT: '  • rkB/s, wkB/s = KB read/written per second'",
      "AGENT: '  • r_await, w_await = Average wait time in ms'",
      "AGENT: '  • %util = Device utilization (> 80% = bottleneck!)'",
      "AGENT: '  • svctm = Service time (deprecated but useful)'",
      "AGENT: ''",
      "Run command: `iostat -d -x -k 1`",
      "AGENT: '  -d = Device statistics only'",
      "AGENT: '  -k = Show in KB (default MB)'",
      "AGENT: ''",
      "Run command: `iostat -p sda`",
      "AGENT: 'Show statistics for specific device and partitions'",
      "AGENT: ''",
      "Run command: `iostat -m -x 2`",
      "AGENT: '  -m = Display in MB/s'",
      "AGENT: ''",
      "AGENT: 'Diagnosis:'",
      "AGENT: '  • High %util (>80%) = Device saturated'",
      "AGENT: '  • High await (>20ms) = Slow responses'",
      "AGENT: '  • High r_await vs w_await = Read or write bottleneck'",
      "AGENT: '  • Low %util but high await = Disk hardware problem'",
      "AGENT: ''",
      "AGENT: 'Solution found: sdb is 85% utilized with high await!'",
      "AGENT: 'Action: Migrate workload, add caching, or upgrade disk'",
      "AGENT: ''",
      "Run command: `iostat -c`",
      "AGENT: '  -c = CPU statistics only'",
      "AGENT: 'avg-cpu:  %user   %nice %system %iowait  %steal   %idle'",
      "AGENT: '           15.2    0.0     8.3    12.5     0.0    64.0'",
      "AGENT: ''",
      "AGENT: 'High %iowait (>10%) = CPU waiting for I/O = disk bottleneck!'",
      "AGENT: ''",
      "Run command: `iostat -t`",
      "AGENT: '  -t = Include timestamp'",
      "AGENT: ''",
      "Run command: `watch -n 2 'iostat -x 1 1'`",
      "AGENT: 'Continuous monitoring with screen refresh'"
    ],
    "commands": ["iostat", "watch"],
    "packages": {
      "debian_ubuntu": ["sysstat"],
      "arch": ["sysstat"]
    },
    "related_commands": ["iotop", "vmstat", "sar", "dstat"],
    "complexity": "intermediate",
    "tags": ["iostat", "disk", "io", "performance", "monitoring", "bottleneck", "storage"]
  },
  {
    "id": "scenario_vmstat_memory_monitoring_129",
    "command": "vmstat",
    "scenario": "Monitor system memory, swap, CPU, and I/O with vmstat.",
    "problem": "Need to analyze overall system performance, check if system is swapping excessively, monitor memory usage trends, identify CPU vs I/O bottlenecks, and understand context switches.",
    "solution": "Use vmstat for comprehensive system statistics, interpret procs/memory/swap/io/system/cpu columns, identify performance issues from patterns, and correlate metrics for root cause analysis.",
    "steps": [
      "USER SAYS: 'System performance is degraded. How do I get a complete view of memory, CPU, and I/O to diagnose the problem?'",
      "AGENT: 'vmstat gives you a complete system overview! It shows memory, swap, I/O, CPU, and processes all in one view.'",
      "AGENT: ''",
      "Run command: `vmstat`",
      "AGENT: 'procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----'",
      "AGENT: ' r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st'",
      "AGENT: ' 2  0      0 1234567  89012 3456789    0    0    12    45  123  456 15  8 64 12  0'",
      "AGENT: ''",
      "Run command: `vmstat 2 10`",
      "AGENT: '  2 = Update every 2 seconds'",
      "AGENT: '  10 = 10 iterations'",
      "AGENT: ''",
      "AGENT: 'procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----'",
      "AGENT: ' r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st'",
      "AGENT: ' 1  0      0 1234567  89012 3456789    0    0    12    45  123  456 15  8 64 12  0'",
      "AGENT: ' 3  1  20480 1100000  89012 3456789    0  256    89   234  567  890 45 15 20 20  0  ← Swapping!'",
      "AGENT: ' 2  2  45000  980000  89012 3456789  512  512   156   456  789 1234 30 10 10 50  0  ← High I/O wait!'",
      "AGENT: ''",
      "AGENT: 'Column meanings:'",
      "AGENT: ''",
      "AGENT: 'Procs:'",
      "AGENT: '  r = Runnable processes (waiting for CPU)'",
      "AGENT: '  b = Blocked processes (waiting for I/O)'",
      "AGENT: ''",
      "AGENT: 'Memory (KB):'",
      "AGENT: '  swpd = Swap used'",
      "AGENT: '  free = Free memory'",
      "AGENT: '  buff = Buffer cache'",
      "AGENT: '  cache = Page cache'",
      "AGENT: ''",
      "AGENT: 'Swap (KB/s):'",
      "AGENT: '  si = Swap in (from disk)'",
      "AGENT: '  so = Swap out (to disk)'",
      "AGENT: ''",
      "AGENT: 'I/O (blocks/s):'",
      "AGENT: '  bi = Blocks in (read)'",
      "AGENT: '  bo = Blocks out (write)'",
      "AGENT: ''",
      "AGENT: 'System:'",
      "AGENT: '  in = Interrupts per second'",
      "AGENT: '  cs = Context switches per second'",
      "AGENT: ''",
      "AGENT: 'CPU (%):'",
      "AGENT: '  us = User time'",
      "AGENT: '  sy = System/kernel time'",
      "AGENT: '  id = Idle'",
      "AGENT: '  wa = I/O wait'",
      "AGENT: '  st = Stolen (VM)'",
      "AGENT: ''",
      "Run command: `vmstat -s`",
      "AGENT: '  -s = Summary statistics'",
      "AGENT: '     16384000 K total memory'",
      "AGENT: '     12345678 K used memory'",
      "AGENT: '      8901234 K active memory'",
      "AGENT: '      3456789 K inactive memory'",
      "AGENT: '      1234567 K free memory'",
      "AGENT: '        89012 K buffer memory'",
      "AGENT: '      3456789 K swap cache'",
      "AGENT: '      8388608 K total swap'",
      "AGENT: '            0 K used swap'",
      "AGENT: '      8388608 K free swap'",
      "AGENT: ''",
      "Run command: `vmstat -d`",
      "AGENT: '  -d = Disk statistics'",
      "AGENT: 'disk- ------------reads------------ ------------writes----------- -----IO------'",
      "AGENT: '       total merged sectors      ms  total merged sectors      ms    cur    sec'",
      "AGENT: 'sda   123456    890 9876543  456789  78901    456 6543210  234567      0    123'",
      "AGENT: ''",
      "Run command: `vmstat -a`",
      "AGENT: '  -a = Active/inactive memory'",
      "AGENT: ''",
      "Run command: `vmstat -w`",
      "AGENT: '  -w = Wide output format'",
      "AGENT: ''",
      "AGENT: 'Diagnosis patterns:'",
      "AGENT: ''",
      "AGENT: '1. Memory pressure:'",
      "AGENT: '   • High swpd + si/so > 0 = System swapping (add RAM!)'",
      "AGENT: '   • free < 10% of total = Low memory'",
      "AGENT: ''",
      "AGENT: '2. CPU bottleneck:'",
      "AGENT: '   • r > # of CPUs = CPU overload'",
      "AGENT: '   • us + sy > 80% = CPU saturated'",
      "AGENT: '   • High cs (>100k) = Too many context switches'",
      "AGENT: ''",
      "AGENT: '3. I/O bottleneck:'",
      "AGENT: '   • b > 0 = Processes blocked on I/O'",
      "AGENT: '   • wa > 20% = Significant I/O wait'",
      "AGENT: '   • High bi/bo = Heavy disk activity'",
      "AGENT: ''",
      "AGENT: '4. Healthy system:'",
      "AGENT: '   • id > 50%'",
      "AGENT: '   • r < # CPUs'",
      "AGENT: '   • si/so = 0 (no swapping)'",
      "AGENT: '   • wa < 5%'",
      "AGENT: ''",
      "Run command: `vmstat -t 1`",
      "AGENT: '  -t = Timestamp'",
      "AGENT: 'Shows time with each line'",
      "AGENT: ''",
      "Run command: `vmstat -S M`",
      "AGENT: '  -S M = Display in megabytes'",
      "AGENT: ''",
      "AGENT: 'Real-world example diagnosis:'",
      "AGENT: 'procs: r=8, b=2  → 8 waiting for CPU, 2 blocked on I/O'",
      "AGENT: 'memory: free dropping, swpd increasing'",
      "AGENT: 'swap: si=512, so=512  → Active swapping!'",
      "AGENT: 'cpu: wa=50%  → Half the time waiting for I/O'",
      "AGENT: ''",
      "AGENT: 'Conclusion: System is memory-starved, swapping heavily,'",
      "AGENT: 'causing high I/O wait. Solution: Add more RAM or reduce'",
      "AGENT: 'memory usage by stopping unnecessary processes.'"
    ],
    "commands": ["vmstat", "free", "top"],
    "packages": {
      "debian_ubuntu": ["procps"],
      "arch": ["procps-ng"]
    },
    "related_commands": ["iostat", "mpstat", "sar", "dstat"],
    "complexity": "intermediate",
    "tags": ["vmstat", "memory", "swap", "cpu", "performance", "monitoring", "system-stats"]
  }
]