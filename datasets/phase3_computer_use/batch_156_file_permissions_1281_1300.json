[
  {
    "id": "scenario_file_permissions_154",
    "command": "chmod",
    "scenario": "Master Linux file permissions and ownership for security and access control.",
    "problem": "Files have wrong permissions, need to make scripts executable, restrict access to sensitive files, understand rwx permissions, manage file ownership, use special permissions (setuid, setgid, sticky bit), and troubleshoot permission denied errors.",
    "solution": "Use chmod to change permissions (numeric and symbolic), chown to change ownership, chgrp for groups, understand permission bits (read=4, write=2, execute=1), apply recursive permissions, and use special permissions appropriately.",
    "steps": [
      "USER SAYS: 'I keep getting \"permission denied\" errors! How do I fix file permissions and make my scripts executable?'",
      "AGENT: 'Let me show you Linux permissions! We'll master chmod, chown, understand rwx notation, and fix all permission issues.'",
      "AGENT: ''",
      "AGENT: 'ðŸ” RESEARCH PHASE: File permissions...'",
      "AGENT: '[Searching] \"linux file permissions chmod chown rwx numeric symbolic\"'",
      "AGENT: '[Found] Permissions: read(r)=4, write(w)=2, execute(x)=1.'",
      "AGENT: '[Found] Three permission sets: owner, group, others.'",
      "AGENT: '[Found] chmod changes permissions, chown changes ownership.'",
      "AGENT: '[Found] Special bits: setuid, setgid, sticky bit.'",
      "AGENT: 'âœ“ Research complete! Let's master permissions.'",
      "AGENT: ''",
      "AGENT: '--- Approach 1: Understanding Permissions ---'",
      "Run command: `ls -l script.sh`",
      "AGENT: '-rw-r--r-- 1 user group 1234 Oct  8 19:00 script.sh'",
      "AGENT: ' ^  ^  ^  ^'",
      "AGENT: ' |  |  |  â””â”€ Others permissions (r-- = read only)'",
      "AGENT: ' |  |  â””â”€ Group permissions (r-- = read only)'",
      "AGENT: ' |  â””â”€ Owner permissions (rw- = read + write)'",
      "AGENT: ' â””â”€ File type (- = file, d = directory, l = link)'",
      "AGENT: ''",
      "AGENT: 'Permission breakdown:'",
      "AGENT: '  r = read (4)'",
      "AGENT: '  w = write (2)'",
      "AGENT: '  x = execute (1)'",
      "AGENT: '  - = no permission (0)'",
      "AGENT: ''",
      "AGENT: 'Example: rw-r--r--'",
      "AGENT: '  Owner:  rw- = read + write = 6'",
      "AGENT: '  Group:  r-- = read only = 4'",
      "AGENT: '  Others: r-- = read only = 4'",
      "AGENT: '  Numeric: 644'",
      "AGENT: ''",
      "AGENT: '--- Approach 2: Make File Executable ---'",
      "Create tool: `cat > hello.sh << 'EOF'`",
      "#!/bin/bash\necho \"Hello, World!\"\nEOF",
      "AGENT: ''",
      "Run command: `ls -l hello.sh`",
      "AGENT: '-rw-r--r-- 1 user group 31 Oct  8 19:00 hello.sh'",
      "AGENT: 'Not executable!'",
      "AGENT: ''",
      "Run command: `./hello.sh`",
      "AGENT: 'bash: ./hello.sh: Permission denied'",
      "AGENT: ''",
      "Run command: `chmod +x hello.sh`",
      "AGENT: 'Add execute permission for all (owner, group, others)'",
      "AGENT: ''",
      "Run command: `ls -l hello.sh`",
      "AGENT: '-rwxr-xr-x 1 user group 31 Oct  8 19:00 hello.sh'",
      "AGENT: '    ^   ^  ^'",
      "AGENT: 'All have execute now!'",
      "AGENT: ''",
      "Run command: `./hello.sh`",
      "AGENT: 'Hello, World!'",
      "AGENT: 'âœ“ Script runs!'",
      "AGENT: ''",
      "AGENT: '--- Approach 3: Numeric Permissions (chmod) ---'",
      "Run command: `chmod 755 script.sh`",
      "AGENT: '  7 = rwx (4+2+1) = Owner: read+write+execute'",
      "AGENT: '  5 = r-x (4+0+1) = Group: read+execute'",
      "AGENT: '  5 = r-x (4+0+1) = Others: read+execute'",
      "AGENT: ''",
      "Run command: `ls -l script.sh`",
      "AGENT: '-rwxr-xr-x 1 user group 1234 Oct  8 19:00 script.sh'",
      "AGENT: ''",
      "AGENT: 'Common numeric permissions:'",
      "AGENT: '  644 = rw-r--r-- (files: owner can edit, others read)'",
      "AGENT: '  755 = rwxr-xr-x (scripts: owner can edit/run, others run)'",
      "AGENT: '  600 = rw------- (private files: only owner access)'",
      "AGENT: '  700 = rwx------ (private scripts: only owner)'",
      "AGENT: '  666 = rw-rw-rw- (world writable - dangerous!)'",
      "AGENT: '  777 = rwxrwxrwx (world executable - very dangerous!)'",
      "AGENT: ''",
      "AGENT: '--- Approach 4: Symbolic Permissions ---'",
      "Run command: `chmod u+x file.txt`",
      "AGENT: '  u = user (owner)'",
      "AGENT: '  + = add'",
      "AGENT: '  x = execute'",
      "AGENT: 'Add execute for owner'",
      "AGENT: ''",
      "Run command: `chmod g+w file.txt`",
      "AGENT: '  g = group'",
      "AGENT: 'Add write for group'",
      "AGENT: ''",
      "Run command: `chmod o-r file.txt`",
      "AGENT: '  o = others'",
      "AGENT: '  - = remove'",
      "AGENT: 'Remove read for others'",
      "AGENT: ''",
      "Run command: `chmod a+x script.sh`",
      "AGENT: '  a = all (user+group+others)'",
      "AGENT: 'Add execute for everyone'",
      "AGENT: ''",
      "Run command: `chmod u=rwx,g=rx,o=r file.txt`",
      "AGENT: 'Set exact permissions (same as chmod 754)'",
      "AGENT: ''",
      "Run command: `chmod go-w file.txt`",
      "AGENT: 'Remove write for group and others'",
      "AGENT: ''",
      "AGENT: '--- Approach 5: Recursive Permissions ---'",
      "Run command: `chmod -R 755 /var/www/html`",
      "AGENT: '  -R = Recursive (all files and subdirectories)'",
      "AGENT: 'Set permissions for entire directory tree'",
      "AGENT: ''",
      "Run command: `find /var/www/html -type d -exec chmod 755 {} \\;`",
      "AGENT: 'Set 755 only on directories'",
      "AGENT: ''",
      "Run command: `find /var/www/html -type f -exec chmod 644 {} \\;`",
      "AGENT: 'Set 644 only on files'",
      "AGENT: ''",
      "AGENT: '--- Approach 6: Change Ownership (chown) ---'",
      "Run command: `ls -l file.txt`",
      "AGENT: '-rw-r--r-- 1 olduser oldgroup 100 Oct  8 19:00 file.txt'",
      "AGENT: ''",
      "Run command: `sudo chown newuser file.txt`",
      "AGENT: 'Change owner to newuser'",
      "AGENT: ''",
      "Run command: `ls -l file.txt`",
      "AGENT: '-rw-r--r-- 1 newuser oldgroup 100 Oct  8 19:00 file.txt'",
      "AGENT: ''",
      "Run command: `sudo chown newuser:newgroup file.txt`",
      "AGENT: 'Change both owner and group'",
      "AGENT: ''",
      "Run command: `ls -l file.txt`",
      "AGENT: '-rw-r--r-- 1 newuser newgroup 100 Oct  8 19:00 file.txt'",
      "AGENT: ''",
      "Run command: `sudo chown -R user:group /var/www`",
      "AGENT: 'Recursive ownership change'",
      "AGENT: ''",
      "Run command: `sudo chown :newgroup file.txt`",
      "AGENT: 'Change only group (same as chgrp)'",
      "AGENT: ''",
      "AGENT: '--- Approach 7: Change Group (chgrp) ---'",
      "Run command: `sudo chgrp developers file.txt`",
      "AGENT: 'Change group to developers'",
      "AGENT: ''",
      "Run command: `sudo chgrp -R www-data /var/www/html`",
      "AGENT: 'Recursive group change'",
      "AGENT: ''",
      "AGENT: '--- Approach 8: Special Permissions ---'",
      "AGENT: ''",
      "AGENT: 'Setuid (Set User ID):'",
      "Run command: `chmod u+s file`",
      "AGENT: 'or'",
      "Run command: `chmod 4755 file`",
      "AGENT: 'Runs with owner\\'s permissions (like sudo)'",
      "AGENT: ''",
      "Run command: `ls -l /usr/bin/passwd`",
      "AGENT: '-rwsr-xr-x 1 root root 68208 passwd'",
      "AGENT: '   ^'",
      "AGENT: '   â””â”€ s = setuid bit (runs as root)'",
      "AGENT: 'Example: passwd needs root to modify /etc/shadow'",
      "AGENT: ''",
      "AGENT: 'Setgid (Set Group ID):'",
      "Run command: `chmod g+s directory`",
      "AGENT: 'or'",
      "Run command: `chmod 2755 directory`",
      "AGENT: 'New files inherit directory\\'s group'",
      "AGENT: ''",
      "Run command: `ls -ld shared-project`",
      "AGENT: 'drwxr-sr-x 2 user developers 4096 Oct  8 19:00 shared-project'",
      "AGENT: '      ^'",
      "AGENT: '      â””â”€ s = setgid bit'",
      "AGENT: 'All files created here belong to \"developers\" group'",
      "AGENT: ''",
      "AGENT: 'Sticky Bit:'",
      "Run command: `chmod +t directory`",
      "AGENT: 'or'",
      "Run command: `chmod 1777 directory`",
      "AGENT: 'Only owner can delete their own files'",
      "AGENT: ''",
      "Run command: `ls -ld /tmp`",
      "AGENT: 'drwxrwxrwt 10 root root 4096 Oct  8 19:00 /tmp'",
      "AGENT: '        ^'",
      "AGENT: '        â””â”€ t = sticky bit'",
      "AGENT: 'Anyone can create, but only delete own files'",
      "AGENT: ''",
      "AGENT: '--- Approach 9: View Permissions in Octal ---'",
      "Run command: `stat -c '%a %n' file.txt`",
      "AGENT: '644 file.txt'",
      "AGENT: 'Shows numeric permissions'",
      "AGENT: ''",
      "Run command: `stat -c '%A %a %n' *`",
      "AGENT: '-rw-r--r-- 644 file1.txt'",
      "AGENT: '-rwxr-xr-x 755 script.sh'",
      "AGENT: 'drwxr-xr-x 755 directory'",
      "AGENT: 'Shows both symbolic and numeric'",
      "AGENT: ''",
      "AGENT: '--- Approach 10: Common Scenarios ---'",
      "AGENT: ''",
      "AGENT: '1. Make script executable:'",
      "Run command: `chmod +x script.sh`",
      "AGENT: ''",
      "AGENT: '2. Secure private file (SSH key):'",
      "Run command: `chmod 600 ~/.ssh/id_rsa`",
      "AGENT: 'Only owner can read/write'",
      "AGENT: ''",
      "AGENT: '3. Web directory (Apache/Nginx):'",
      "Run command: `sudo chown -R www-data:www-data /var/www/html`",
      "Run command: `sudo find /var/www/html -type d -exec chmod 755 {} \\;`",
      "Run command: `sudo find /var/www/html -type f -exec chmod 644 {} \\;`",
      "AGENT: 'Directories: 755, Files: 644'",
      "AGENT: ''",
      "AGENT: '4. Shared project directory:'",
      "Run command: `sudo mkdir /shared/project`",
      "Run command: `sudo chgrp developers /shared/project`",
      "Run command: `sudo chmod 2775 /shared/project`",
      "AGENT: '  2 = setgid (new files inherit group)'",
      "AGENT: '  775 = rwxrwxr-x (team can read/write/execute)'",
      "AGENT: ''",
      "AGENT: '5. Fix \"permission denied\" for scripts in ~/bin:'",
      "Run command: `chmod +x ~/bin/*`",
      "AGENT: ''",
      "AGENT: '6. Restrict sensitive config file:'",
      "Run command: `sudo chmod 600 /etc/myapp/secrets.conf`",
      "Run command: `sudo chown root:root /etc/myapp/secrets.conf`",
      "AGENT: ''",
      "AGENT: '--- Bonus: Permission Calculator ---'",
      "AGENT: ''",
      "AGENT: 'Calculate numeric from rwx:'",
      "AGENT: '  r = 4, w = 2, x = 1'",
      "AGENT: ''",
      "AGENT: '  rwx = 4+2+1 = 7'",
      "AGENT: '  rw- = 4+2+0 = 6'",
      "AGENT: '  r-x = 4+0+1 = 5'",
      "AGENT: '  r-- = 4+0+0 = 4'",
      "AGENT: '  -wx = 0+2+1 = 3'",
      "AGENT: '  -w- = 0+2+0 = 2'",
      "AGENT: '  --x = 0+0+1 = 1'",
      "AGENT: '  --- = 0+0+0 = 0'",
      "AGENT: ''",
      "AGENT: 'Example: rwxr-xr-- '",
      "AGENT: '  Owner:  rwx = 7'",
      "AGENT: '  Group:  r-x = 5'",
      "AGENT: '  Others: r-- = 4'",
      "AGENT: '  Result: 754'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Permission Check Script ---'",
      "Create tool: `cat > check-permissions.sh << 'EOF'`",
      "#!/bin/bash\nset -euo pipefail\n\nif [ $# -eq 0 ]; then\n    echo \"Usage: $0 <file>\"\n    exit 1\nfi\n\nFILE=\"$1\"\n\nif [ ! -e \"$FILE\" ]; then\n    echo \"File not found: $FILE\"\n    exit 1\nfi\n\necho \"=== Permission Analysis: $FILE ===\"\necho \"\"\n\n# Symbolic permissions\nPERM=$(stat -c '%A' \"$FILE\")\necho \"Symbolic: $PERM\"\n\n# Numeric permissions\nOCTAL=$(stat -c '%a' \"$FILE\")\necho \"Numeric:  $OCTAL\"\n\n# Owner and group\nOWNER=$(stat -c '%U' \"$FILE\")\nGROUP=$(stat -c '%G' \"$FILE\")\necho \"Owner:    $OWNER\"\necho \"Group:    $GROUP\"\n\n# File type\nif [ -f \"$FILE\" ]; then\n    echo \"Type:     Regular file\"\nelif [ -d \"$FILE\" ]; then\n    echo \"Type:     Directory\"\nelif [ -L \"$FILE\" ]; then\n    echo \"Type:     Symbolic link\"\nfi\n\necho \"\"\necho \"Permission Breakdown:\"\necho \"  Owner:  ${PERM:1:3}\"\necho \"  Group:  ${PERM:4:3}\"\necho \"  Others: ${PERM:7:3}\"\n\necho \"\"\necho \"Access Check:\"\nif [ -r \"$FILE\" ]; then echo \"  âœ“ You can read\"; else echo \"  âœ— Cannot read\"; fi\nif [ -w \"$FILE\" ]; then echo \"  âœ“ You can write\"; else echo \"  âœ— Cannot write\"; fi\nif [ -x \"$FILE\" ]; then echo \"  âœ“ You can execute\"; else echo \"  âœ— Cannot execute\"; fi\nEOF",
      "Run command: `chmod +x check-permissions.sh`",
      "Run command: `./check-permissions.sh /etc/passwd`",
      "AGENT: ''",
      "AGENT: '--- Bonus: Fix Common Permission Issues ---'",
      "Create tool: `cat > fix-web-permissions.sh << 'EOF'`",
      "#!/bin/bash\nset -euo pipefail\n\nif [ \"$(id -u)\" -ne 0 ]; then\n    echo \"Must run as root\"\n    exit 1\nfi\n\nWWW_DIR=\"/var/www/html\"\n\necho \"Fixing web directory permissions: $WWW_DIR\"\n\n# Set ownership\nchown -R www-data:www-data \"$WWW_DIR\"\n\n# Directories: 755 (rwxr-xr-x)\nfind \"$WWW_DIR\" -type d -exec chmod 755 {} \\;\n\n# Files: 644 (rw-r--r--)\nfind \"$WWW_DIR\" -type f -exec chmod 644 {} \\;\n\n# Make specific scripts executable\nif [ -d \"$WWW_DIR/bin\" ]; then\n    chmod +x \"$WWW_DIR\"/bin/*.sh 2>/dev/null || true\nfi\n\necho \"âœ“ Permissions fixed!\"\nEOF",
      "AGENT: ''",
      "AGENT: '--- Bonus: Quick Commands Reference ---'",
      "AGENT: ''",
      "AGENT: 'Make executable:'",
      "AGENT: '  chmod +x file'",
      "AGENT: '  chmod 755 file'",
      "AGENT: ''",
      "AGENT: 'Private file:'",
      "AGENT: '  chmod 600 file'",
      "AGENT: '  chmod u=rw,go= file'",
      "AGENT: ''",
      "AGENT: 'Standard file:'",
      "AGENT: '  chmod 644 file'",
      "AGENT: ''",
      "AGENT: 'Change owner:'",
      "AGENT: '  chown user file'",
      "AGENT: '  chown user:group file'",
      "AGENT: ''",
      "AGENT: 'Change group:'",
      "AGENT: '  chgrp group file'",
      "AGENT: '  chown :group file'",
      "AGENT: ''",
      "AGENT: 'Recursive:'",
      "AGENT: '  chmod -R 755 directory'",
      "AGENT: '  chown -R user:group directory'",
      "AGENT: ''",
      "AGENT: 'View permissions:'",
      "AGENT: '  ls -l file'",
      "AGENT: '  stat -c \"%a %n\" file'",
      "AGENT: ''",
      "AGENT: 'âœ“ SOLUTION SUMMARY:'",
      "AGENT: '  âœ“ Understood rwx permissions (read, write, execute).'",
      "AGENT: '  âœ“ Made scripts executable with chmod +x.'",
      "AGENT: '  âœ“ Used numeric permissions (644, 755, 600).'",
      "AGENT: '  âœ“ Applied symbolic permissions (u+x, g-w, o=r).'",
      "AGENT: '  âœ“ Changed ownership with chown and chgrp.'",
      "AGENT: '  âœ“ Used recursive permissions for directories.'",
      "AGENT: '  âœ“ Understood special bits (setuid, setgid, sticky).'",
      "AGENT: '  âœ“ Fixed common permission issues.'",
      "AGENT: '  âœ“ Created permission analysis scripts.'",
      "AGENT: '  âœ“ You now master Linux file permissions! ðŸ”’'"
    ],
    "commands": ["chmod", "chown", "chgrp", "stat"],
    "packages": {
      "debian_ubuntu": ["coreutils"],
      "arch": ["coreutils"]
    },
    "related_commands": ["ls", "umask", "getfacl", "setfacl"],
    "complexity": "intermediate",
    "tags": ["permissions", "chmod", "chown", "rwx", "file-permissions", "ownership", "security", "access-control"]
  }
]
