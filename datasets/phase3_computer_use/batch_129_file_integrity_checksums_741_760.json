[
  {
    "id": "scenario_file_integrity_checksums_132",
    "command": "md5sum",
    "scenario": "Verify file integrity and detect tampering with checksums and hash functions.",
    "problem": "Need to verify downloaded files haven't been corrupted, detect if files have been tampered with, compare file contents without opening them, create checksums for backup verification, and ensure data integrity.",
    "solution": "Use md5sum, sha256sum, and sha512sum to generate cryptographic hashes, verify against known checksums, create checksum files for directories, detect duplicate files, and implement integrity checking in backup workflows.",
    "steps": [
      "USER SAYS: 'How do I verify that a downloaded file hasn't been corrupted or tampered with? And how can I check if files have changed?'",
      "AGENT: 'Let me show you file integrity verification with checksums! We'll use md5sum, sha256sum, and sha512sum to generate and verify hashes.'",
      "AGENT: ''",
      "AGENT: '🔍 RESEARCH PHASE: File integrity and checksums...'",
      "AGENT: '[Searching] \"md5sum sha256sum file integrity verification checksums\"'",
      "AGENT: '[Found] Checksums create unique fingerprints of file contents.'",
      "AGENT: '[Found] MD5 fast but cryptographically broken, use SHA256/SHA512.'",
      "AGENT: '[Found] -c flag verifies files against checksum file.'",
      "AGENT: '[Found] Useful for downloads, backups, duplicate detection.'",
      "AGENT: '✓ Research complete! Let's verify file integrity.'",
      "AGENT: ''",
      "AGENT: '--- Approach 1: Generate MD5 Checksum ---'",
      "Create tool: `echo \"Hello World\" > test.txt`",
      "AGENT: ''",
      "Run command: `md5sum test.txt`",
      "AGENT: 'e59ff97941044f85df5297e1c302d260  test.txt'",
      "AGENT: '└────────────────────────────────┘  └────────┘'",
      "AGENT: '           MD5 hash              filename'",
      "AGENT: ''",
      "Run command: `md5sum test.txt > test.txt.md5`",
      "AGENT: 'Saves checksum to file'",
      "AGENT: ''",
      "Run command: `cat test.txt.md5`",
      "AGENT: 'e59ff97941044f85df5297e1c302d260  test.txt'",
      "AGENT: ''",
      "AGENT: '--- Approach 2: Verify File Integrity ---'",
      "Run command: `md5sum -c test.txt.md5`",
      "AGENT: 'test.txt: OK'",
      "AGENT: '✓ File is intact!'",
      "AGENT: ''",
      "AGENT: 'Now modify the file:'",
      "Run command: `echo \"Modified\" >> test.txt`",
      "AGENT: ''",
      "Run command: `md5sum -c test.txt.md5`",
      "AGENT: 'test.txt: FAILED'",
      "AGENT: 'md5sum: WARNING: 1 computed checksum did NOT match'",
      "AGENT: '⚠️ File has been modified!'",
      "AGENT: ''",
      "AGENT: '--- Approach 3: SHA256 (More Secure) ---'",
      "Run command: `sha256sum test.txt`",
      "AGENT: 'a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e  test.txt'",
      "AGENT: '└──────────────────────────────────────────────────────────────┘'",
      "AGENT: '                   SHA256 hash (64 hex chars)'",
      "AGENT: ''",
      "Run command: `sha256sum test.txt > test.txt.sha256`",
      "Run command: `sha256sum -c test.txt.sha256`",
      "AGENT: 'test.txt: OK'",
      "AGENT: ''",
      "AGENT: '--- Approach 4: SHA512 (Most Secure) ---'",
      "Run command: `sha512sum test.txt`",
      "AGENT: '2c74fd17edafd80e8447b0d46741ee243b7eb74dd2149a0ab1b9246fb30382f27e853d8585719e0e67cbda0daa8f51671064615d645ae27acb15bfb1447f459b  test.txt'",
      "AGENT: '└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘'",
      "AGENT: '                                                 SHA512 hash (128 hex chars)'",
      "AGENT: ''",
      "AGENT: '--- Approach 5: Multiple Files ---'",
      "Create tool: `echo \"File 1\" > file1.txt`",
      "Create tool: `echo \"File 2\" > file2.txt`",
      "Create tool: `echo \"File 3\" > file3.txt`",
      "AGENT: ''",
      "Run command: `md5sum file1.txt file2.txt file3.txt`",
      "AGENT: 'a4b8b5b9c36d8a3c6f4e8e3c2b1a9d8e  file1.txt'",
      "AGENT: 'b5c9d8e7f3a2b4c6d8e9f2a3b5c7d8e9  file2.txt'",
      "AGENT: 'c7d9e8f2a3b4c5d7e9f3a4b6c8d9e2f3  file3.txt'",
      "AGENT: ''",
      "Run command: `md5sum file*.txt > checksums.md5`",
      "Run command: `cat checksums.md5`",
      "AGENT: 'a4b8b5b9c36d8a3c6f4e8e3c2b1a9d8e  file1.txt'",
      "AGENT: 'b5c9d8e7f3a2b4c6d8e9f2a3b5c7d8e9  file2.txt'",
      "AGENT: 'c7d9e8f2a3b4c5d7e9f3a4b6c8d9e2f3  file3.txt'",
      "AGENT: ''",
      "Run command: `md5sum -c checksums.md5`",
      "AGENT: 'file1.txt: OK'",
      "AGENT: 'file2.txt: OK'",
      "AGENT: 'file3.txt: OK'",
      "AGENT: ''",
      "AGENT: '--- Approach 6: Directory Checksum ---'",
      "Run command: `find /var/www/html -type f -exec md5sum {} \\; > website-checksums.md5`",
      "AGENT: 'Creates checksums for all files in directory'",
      "AGENT: ''",
      "Run command: `md5sum -c website-checksums.md5`",
      "AGENT: '/var/www/html/index.html: OK'",
      "AGENT: '/var/www/html/style.css: OK'",
      "AGENT: '/var/www/html/script.js: OK'",
      "AGENT: '...'",
      "AGENT: ''",
      "AGENT: 'Or with relative paths:'",
      "Run command: `cd /var/www/html && find . -type f -exec md5sum {} \\; > checksums.md5`",
      "AGENT: ''",
      "AGENT: '--- Approach 7: Verify Downloaded File ---'",
      "Run command: `wget https://example.com/file.tar.gz`",
      "Run command: `wget https://example.com/file.tar.gz.sha256`",
      "AGENT: ''",
      "Run command: `cat file.tar.gz.sha256`",
      "AGENT: 'a1b2c3d4e5f6... file.tar.gz'",
      "AGENT: ''",
      "Run command: `sha256sum -c file.tar.gz.sha256`",
      "AGENT: 'file.tar.gz: OK'",
      "AGENT: '✓ Download verified, file is authentic!'",
      "AGENT: ''",
      "AGENT: 'Or compare manually:'",
      "Run command: `sha256sum file.tar.gz`",
      "AGENT: 'a1b2c3d4e5f6789abcdef... file.tar.gz'",
      "AGENT: ''",
      "AGENT: 'Compare with official checksum from website'",
      "AGENT: ''",
      "AGENT: '--- Approach 8: Find Duplicate Files ---'",
      "Run command: `find . -type f -exec md5sum {} \\; | sort | uniq -w32 -D`",
      "AGENT: '  uniq -w32 = Compare first 32 chars (MD5 hash)'",
      "AGENT: '  -D = Print all duplicates'",
      "AGENT: ''",
      "AGENT: 'a1b2c3d4e5f6789...  ./file1.txt'",
      "AGENT: 'a1b2c3d4e5f6789...  ./backup/file1.txt'",
      "AGENT: '└─ Same hash = duplicate files!'",
      "AGENT: ''",
      "AGENT: 'Better duplicate finder:'",
      "Run command: `find . -type f -exec md5sum {} \\; | sort | uniq -w32 -d --all-repeated=separate`",
      "AGENT: ''",
      "AGENT: '--- Approach 9: Compare Two Files ---'",
      "Create tool: `cp file1.txt file1-copy.txt`",
      "AGENT: ''",
      "Run command: `md5sum file1.txt file1-copy.txt`",
      "AGENT: 'a4b8b5b9c36d8a3c6f4e8e3c2b1a9d8e  file1.txt'",
      "AGENT: 'a4b8b5b9c36d8a3c6f4e8e3c2b1a9d8e  file1-copy.txt'",
      "AGENT: '✓ Same hash = identical files!'",
      "AGENT: ''",
      "Run command: `echo \"extra\" >> file1-copy.txt`",
      "Run command: `md5sum file1.txt file1-copy.txt`",
      "AGENT: 'a4b8b5b9c36d8a3c6f4e8e3c2b1a9d8e  file1.txt'",
      "AGENT: 'b5c9d8e7f3a2b4c6d8e9f2a3b5c7d8e9  file1-copy.txt'",
      "AGENT: '✗ Different hashes = files differ!'",
      "AGENT: ''",
      "AGENT: '--- Approach 10: Backup Verification Script ---'",
      "Create tool: `cat > verify-backup.sh << 'EOF'`",
      "#!/bin/bash\nset -euo pipefail\n\nSOURCE_DIR=\"${1:-/var/www/html}\"\nBACKUP_DIR=\"${2:-/backup/www}\"\nCHECKSUM_FILE=\"${3:-backup-checksums.sha256}\"\n\necho \"=== Backup Verification ===\"\necho \"Source: $SOURCE_DIR\"\necho \"Backup: $BACKUP_DIR\"\necho \"\"\n\n# Generate checksums for source\necho \"Generating source checksums...\"\ncd \"$SOURCE_DIR\"\nfind . -type f -exec sha256sum {} \\; | sort -k2 > \"/tmp/source-checksums.txt\"\n\n# Generate checksums for backup\necho \"Generating backup checksums...\"\ncd \"$BACKUP_DIR\"\nfind . -type f -exec sha256sum {} \\; | sort -k2 > \"/tmp/backup-checksums.txt\"\n\n# Compare\necho \"\"\necho \"Comparing...\"\nif diff -q \"/tmp/source-checksums.txt\" \"/tmp/backup-checksums.txt\" > /dev/null; then\n    echo \"✓ Backup verified: All files match!\"\n    exit 0\nelse\n    echo \"✗ Backup verification FAILED:\"\n    echo \"\"\n    diff \"/tmp/source-checksums.txt\" \"/tmp/backup-checksums.txt\" | head -20\n    exit 1\nfi\nEOF",
      "Run command: `chmod +x verify-backup.sh`",
      "Run command: `./verify-backup.sh /var/www/html /backup/www`",
      "AGENT: '=== Backup Verification ==='",
      "AGENT: 'Source: /var/www/html'",
      "AGENT: 'Backup: /backup/www'",
      "AGENT: ''",
      "AGENT: 'Generating source checksums...'",
      "AGENT: 'Generating backup checksums...'",
      "AGENT: ''",
      "AGENT: 'Comparing...'",
      "AGENT: '✓ Backup verified: All files match!'",
      "AGENT: ''",
      "AGENT: '--- Bonus: File Integrity Monitoring ---'",
      "Create tool: `cat > monitor-integrity.sh << 'EOF'`",
      "#!/bin/bash\nset -euo pipefail\n\nWATCH_DIR=\"${1:-/etc}\"\nCHECKSUM_FILE=\"$HOME/.integrity-monitor-$(echo \"$WATCH_DIR\" | tr / _).sha256\"\n\nif [ ! -f \"$CHECKSUM_FILE\" ]; then\n    echo \"Creating baseline checksums for $WATCH_DIR...\"\n    find \"$WATCH_DIR\" -type f -exec sha256sum {} \\; 2>/dev/null | sort -k2 > \"$CHECKSUM_FILE\"\n    echo \"Baseline created: $CHECKSUM_FILE\"\n    exit 0\nfi\n\necho \"Checking integrity of $WATCH_DIR...\"\necho \"\"\n\nfind \"$WATCH_DIR\" -type f -exec sha256sum {} \\; 2>/dev/null | sort -k2 > \"/tmp/current-checksums.txt\"\n\nif diff -q \"$CHECKSUM_FILE\" \"/tmp/current-checksums.txt\" > /dev/null; then\n    echo \"✓ No changes detected\"\nelse\n    echo \"⚠️  Changes detected:\"\n    echo \"\"\n    \n    # Show what changed\n    diff --unchanged-line-format='' --old-line-format='- %L' --new-line-format='+ %L' \\\n        \"$CHECKSUM_FILE\" \"/tmp/current-checksums.txt\" | head -50\n    \n    echo \"\"\n    read -p \"Update baseline? (y/n) \" -n 1 -r\n    echo\n    if [[ $REPLY =~ ^[Yy]$ ]]; then\n        cp \"/tmp/current-checksums.txt\" \"$CHECKSUM_FILE\"\n        echo \"Baseline updated\"\n    fi\nfi\nEOF",
      "Run command: `chmod +x monitor-integrity.sh`",
      "Run command: `./monitor-integrity.sh /etc`",
      "AGENT: 'Creating baseline checksums for /etc...'",
      "AGENT: 'Baseline created: /home/user/.integrity-monitor-_etc.sha256'",
      "AGENT: ''",
      "AGENT: 'Later:'",
      "Run command: `./monitor-integrity.sh /etc`",
      "AGENT: 'Checking integrity of /etc...'",
      "AGENT: ''",
      "AGENT: '⚠️  Changes detected:'",
      "AGENT: ''",
      "AGENT: '- a1b2c3... /etc/ssh/sshd_config'",
      "AGENT: '+ d4e5f6... /etc/ssh/sshd_config'",
      "AGENT: ''",
      "AGENT: 'Update baseline? (y/n) _'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Checksum Quick Reference ---'",
      "AGENT: ''",
      "AGENT: 'Generate:'",
      "AGENT: '  md5sum file.txt'",
      "AGENT: '  sha256sum file.txt'",
      "AGENT: '  sha512sum file.txt'",
      "AGENT: ''",
      "AGENT: 'Save to file:'",
      "AGENT: '  sha256sum file.txt > file.txt.sha256'",
      "AGENT: ''",
      "AGENT: 'Verify:'",
      "AGENT: '  sha256sum -c file.txt.sha256'",
      "AGENT: ''",
      "AGENT: 'Multiple files:'",
      "AGENT: '  sha256sum *.txt > checksums.sha256'",
      "AGENT: '  sha256sum -c checksums.sha256'",
      "AGENT: ''",
      "AGENT: 'Directory:'",
      "AGENT: '  find . -type f -exec sha256sum {} \\; > dir-checksums.sha256'",
      "AGENT: ''",
      "AGENT: 'Find duplicates:'",
      "AGENT: '  find . -type f -exec md5sum {} \\; | sort | uniq -w32 -D'",
      "AGENT: ''",
      "AGENT: '--- Bonus: When to Use Which Hash ---'",
      "AGENT: ''",
      "AGENT: 'MD5:'",
      "AGENT: '  ✓ Fast'",
      "AGENT: '  ✓ Good for non-security: duplicate detection, quick checks'",
      "AGENT: '  ✗ Cryptographically broken - DO NOT use for security!'",
      "AGENT: ''",
      "AGENT: 'SHA256:'",
      "AGENT: '  ✓ Secure for most purposes'",
      "AGENT: '  ✓ Good balance of speed and security'",
      "AGENT: '  ✓ Use for: downloads, backups, integrity checks'",
      "AGENT: ''",
      "AGENT: 'SHA512:'",
      "AGENT: '  ✓ Most secure'",
      "AGENT: '  ✓ Use for: highly sensitive data, long-term verification'",
      "AGENT: '  ✗ Slower, larger hashes'",
      "AGENT: ''",
      "AGENT: '✓ SOLUTION SUMMARY:'",
      "AGENT: '  ✓ Generated file checksums with md5sum, sha256sum, sha512sum.'",
      "AGENT: '  ✓ Verified file integrity with -c flag.'",
      "AGENT: '  ✓ Detected file modifications by comparing hashes.'",
      "AGENT: '  ✓ Created checksum files for multiple files and directories.'",
      "AGENT: '  ✓ Verified downloaded files against official checksums.'",
      "AGENT: '  ✓ Found duplicate files by comparing hashes.'",
      "AGENT: '  ✓ Built backup verification script.'",
      "AGENT: '  ✓ Created file integrity monitoring system.'",
      "AGENT: '  ✓ Understood when to use MD5 vs SHA256 vs SHA512.'",
      "AGENT: '  ✓ You now master file integrity verification! 🔐'"
    ],
    "commands": ["md5sum", "sha256sum", "sha512sum", "find", "diff", "sort", "uniq"],
    "packages": {
      "debian_ubuntu": ["coreutils"],
      "arch": ["coreutils"]
    },
    "related_commands": ["cksum", "b2sum", "sha1sum"],
    "complexity": "intermediate",
    "tags": ["checksums", "md5sum", "sha256sum", "file-integrity", "verification", "hash", "security", "backup-verification", "duplicate-detection"]
  }
]
