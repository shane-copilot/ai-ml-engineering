[
  {
    "id": "scenario_database_cli_mysql_140",
    "command": "mysql",
    "scenario": "Interact with MySQL databases from command line for management and queries.",
    "problem": "Need to create databases, manage tables, run SQL queries, import/export data, manage users and permissions, backup databases, and perform database administration tasks from CLI.",
    "solution": "Use mysql command-line client for interactive queries, understand database operations, manage users with GRANT/REVOKE, use mysqldump for backups, import SQL files, and automate database tasks with scripts.",
    "steps": [
      "USER SAYS: 'How do I work with MySQL databases from the command line? I need to create databases, run queries, and manage users.'",
      "AGENT: 'Let me show you MySQL CLI! We'll cover connecting, creating databases, running queries, managing users, and backups.'",
      "AGENT: ''",
      "AGENT: 'üîç RESEARCH PHASE: MySQL command-line operations...'",
      "AGENT: '[Searching] \"mysql cli commands database queries user management backup\"'",
      "AGENT: '[Found] mysql -u username -p for login.'",
      "AGENT: '[Found] CREATE DATABASE, USE, CREATE TABLE for schema.'",
      "AGENT: '[Found] GRANT/REVOKE for user permissions.'",
      "AGENT: '[Found] mysqldump for backups, mysql < file.sql for import.'",
      "AGENT: '‚úì Research complete! Let's master MySQL CLI.'",
      "AGENT: ''",
      "AGENT: '--- Approach 1: Install MySQL ---'",
      "Run command: `sudo apt install mysql-server -y`",
      "AGENT: ''",
      "Run command: `sudo systemctl start mysql`",
      "Run command: `sudo systemctl enable mysql`",
      "AGENT: ''",
      "Run command: `sudo mysql_secure_installation`",
      "AGENT: 'Sets root password and secures installation'",
      "AGENT: ''",
      "AGENT: '--- Approach 2: Connect to MySQL ---'",
      "Run command: `mysql -u root -p`",
      "AGENT: 'Enter password:'",
      "AGENT: 'Welcome to the MySQL monitor.'",
      "AGENT: 'mysql>'",
      "AGENT: ''",
      "AGENT: 'Connect to specific database:'",
      "Run command: `mysql -u root -p mydatabase`",
      "AGENT: ''",
      "AGENT: 'Connect from specific host:'",
      "Run command: `mysql -h localhost -u root -p`",
      "AGENT: ''",
      "AGENT: '--- Approach 3: Create Database and Tables ---'",
      "Run command: `mysql -u root -p`",
      "AGENT: ''",
      "AGENT: 'mysql> SHOW DATABASES;'",
      "AGENT: '+--------------------+'",
      "AGENT: '| Database           |'",
      "AGENT: '+--------------------+'",
      "AGENT: '| information_schema |'",
      "AGENT: '| mysql              |'",
      "AGENT: '| performance_schema |'",
      "AGENT: '+--------------------+'",
      "AGENT: ''",
      "AGENT: 'mysql> CREATE DATABASE myapp;'",
      "AGENT: 'Query OK, 1 row affected'",
      "AGENT: ''",
      "AGENT: 'mysql> USE myapp;'",
      "AGENT: 'Database changed'",
      "AGENT: ''",
      "AGENT: 'mysql> CREATE TABLE users ('",
      "AGENT: '    -> id INT AUTO_INCREMENT PRIMARY KEY,'",
      "AGENT: '    -> username VARCHAR(50) NOT NULL UNIQUE,'",
      "AGENT: '    -> email VARCHAR(100) NOT NULL,'",
      "AGENT: '    -> created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP'",
      "AGENT: '    -> );'",
      "AGENT: 'Query OK, 0 rows affected'",
      "AGENT: ''",
      "AGENT: 'mysql> SHOW TABLES;'",
      "AGENT: '+----------------+'",
      "AGENT: '| Tables_in_myapp|'",
      "AGENT: '+----------------+'",
      "AGENT: '| users          |'",
      "AGENT: '+----------------+'",
      "AGENT: ''",
      "AGENT: 'mysql> DESCRIBE users;'",
      "AGENT: '+------------+--------------+------+-----+-------------------+'",
      "AGENT: '| Field      | Type         | Null | Key | Default           |'",
      "AGENT: '+------------+--------------+------+-----+-------------------+'",
      "AGENT: '| id         | int          | NO   | PRI | NULL              |'",
      "AGENT: '| username   | varchar(50)  | NO   | UNI | NULL              |'",
      "AGENT: '| email      | varchar(100) | NO   |     | NULL              |'",
      "AGENT: '| created_at | timestamp    | YES  |     | CURRENT_TIMESTAMP |'",
      "AGENT: '+------------+--------------+------+-----+-------------------+'",
      "AGENT: ''",
      "AGENT: '--- Approach 4: Insert and Query Data ---'",
      "AGENT: ''",
      "AGENT: 'mysql> INSERT INTO users (username, email) VALUES'",
      "AGENT: '    -> (\\'alice\\', \\'alice@example.com\\'),'",
      "AGENT: '    -> (\\'bob\\', \\'bob@example.com\\'),'",
      "AGENT: '    -> (\\'charlie\\', \\'charlie@example.com\\');'",
      "AGENT: 'Query OK, 3 rows affected'",
      "AGENT: ''",
      "AGENT: 'mysql> SELECT * FROM users;'",
      "AGENT: '+----+----------+---------------------+---------------------+'",
      "AGENT: '| id | username | email               | created_at          |'",
      "AGENT: '+----+----------+---------------------+---------------------+'",
      "AGENT: '|  1 | alice    | alice@example.com   | 2025-10-08 19:00:00 |'",
      "AGENT: '|  2 | bob      | bob@example.com     | 2025-10-08 19:00:01 |'",
      "AGENT: '|  3 | charlie  | charlie@example.com | 2025-10-08 19:00:02 |'",
      "AGENT: '+----+----------+---------------------+---------------------+'",
      "AGENT: ''",
      "AGENT: 'mysql> SELECT username, email FROM users WHERE id = 1;'",
      "AGENT: '+----------+-------------------+'",
      "AGENT: '| username | email             |'",
      "AGENT: '+----------+-------------------+'",
      "AGENT: '| alice    | alice@example.com |'",
      "AGENT: '+----------+-------------------+'",
      "AGENT: ''",
      "AGENT: 'mysql> UPDATE users SET email = \\'alice.smith@example.com\\' WHERE id = 1;'",
      "AGENT: 'Query OK, 1 row affected'",
      "AGENT: ''",
      "AGENT: 'mysql> DELETE FROM users WHERE id = 3;'",
      "AGENT: 'Query OK, 1 row affected'",
      "AGENT: ''",
      "AGENT: '--- Approach 5: User Management ---'",
      "AGENT: ''",
      "AGENT: 'mysql> CREATE USER \\'appuser\\'@\\'localhost\\' IDENTIFIED BY \\'password123\\';'",
      "AGENT: 'Query OK, 0 rows affected'",
      "AGENT: ''",
      "AGENT: 'mysql> GRANT ALL PRIVILEGES ON myapp.* TO \\'appuser\\'@\\'localhost\\';'",
      "AGENT: 'Query OK, 0 rows affected'",
      "AGENT: ''",
      "AGENT: 'mysql> FLUSH PRIVILEGES;'",
      "AGENT: 'Query OK, 0 rows affected'",
      "AGENT: ''",
      "AGENT: 'mysql> SHOW GRANTS FOR \\'appuser\\'@\\'localhost\\';'",
      "AGENT: '+---------------------------------------------------------------+'",
      "AGENT: '| Grants for appuser@localhost                                  |'",
      "AGENT: '+---------------------------------------------------------------+'",
      "AGENT: '| GRANT ALL PRIVILEGES ON `myapp`.* TO `appuser`@`localhost`   |'",
      "AGENT: '+---------------------------------------------------------------+'",
      "AGENT: ''",
      "AGENT: 'Grant specific privileges:'",
      "AGENT: 'mysql> GRANT SELECT, INSERT, UPDATE ON myapp.* TO \\'readonly\\'@\\'localhost\\';'",
      "AGENT: ''",
      "AGENT: 'Revoke privileges:'",
      "AGENT: 'mysql> REVOKE INSERT ON myapp.* FROM \\'readonly\\'@\\'localhost\\';'",
      "AGENT: ''",
      "AGENT: 'Drop user:'",
      "AGENT: 'mysql> DROP USER \\'appuser\\'@\\'localhost\\';'",
      "AGENT: ''",
      "AGENT: '--- Approach 6: Execute SQL from Command Line ---'",
      "Run command: `mysql -u root -p -e \"SHOW DATABASES;\"`",
      "AGENT: 'Executes single command without interactive shell'",
      "AGENT: ''",
      "Run command: `mysql -u root -p myapp -e \"SELECT COUNT(*) FROM users;\"`",
      "AGENT: '+----------+'",
      "AGENT: '| COUNT(*) |'",
      "AGENT: '+----------+'",
      "AGENT: '|        2 |'",
      "AGENT: '+----------+'",
      "AGENT: ''",
      "Run command: `mysql -u root -p myapp <<< \"SELECT * FROM users;\"`",
      "AGENT: 'Using heredoc'",
      "AGENT: ''",
      "AGENT: '--- Approach 7: Import and Export ---'",
      "AGENT: ''",
      "AGENT: 'Export database (backup):'",
      "Run command: `mysqldump -u root -p myapp > myapp_backup.sql`",
      "AGENT: 'Creates SQL dump file'",
      "AGENT: ''",
      "Run command: `ls -lh myapp_backup.sql`",
      "AGENT: '-rw-r--r-- 1 user user 2.3K Oct  8 19:00 myapp_backup.sql'",
      "AGENT: ''",
      "AGENT: 'Export specific tables:'",
      "Run command: `mysqldump -u root -p myapp users > users_backup.sql`",
      "AGENT: ''",
      "AGENT: 'Export with compression:'",
      "Run command: `mysqldump -u root -p myapp | gzip > myapp_backup.sql.gz`",
      "AGENT: ''",
      "AGENT: 'Import database:'",
      "Run command: `mysql -u root -p myapp < myapp_backup.sql`",
      "AGENT: 'Restores from SQL dump'",
      "AGENT: ''",
      "AGENT: 'Import compressed:'",
      "Run command: `gunzip < myapp_backup.sql.gz | mysql -u root -p myapp`",
      "AGENT: ''",
      "AGENT: 'Import SQL file:'",
      "Run command: `mysql -u root -p myapp < schema.sql`",
      "AGENT: ''",
      "AGENT: '--- Approach 8: Database Backup Script ---'",
      "Create tool: `cat > mysql-backup.sh << 'EOF'`",
      "#!/bin/bash\nset -euo pipefail\n\nDB_USER=\"root\"\nDB_PASS=\"your_password\"\nDB_NAME=\"myapp\"\nBACKUP_DIR=\"/backup/mysql\"\nDATE=$(date +\"%Y%m%d_%H%M%S\")\nBACKUP_FILE=\"$BACKUP_DIR/${DB_NAME}_${DATE}.sql.gz\"\n\nmkdir -p \"$BACKUP_DIR\"\n\necho \"Backing up database: $DB_NAME\"\nmysqldump -u \"$DB_USER\" -p\"$DB_PASS\" \"$DB_NAME\" | gzip > \"$BACKUP_FILE\"\n\nif [ -f \"$BACKUP_FILE\" ]; then\n    SIZE=$(du -h \"$BACKUP_FILE\" | cut -f1)\n    echo \"Backup created: $BACKUP_FILE ($SIZE)\"\nelse\n    echo \"Backup failed!\" >&2\n    exit 1\nfi\n\n# Keep only last 7 backups\nls -t \"$BACKUP_DIR\"/*.sql.gz | tail -n +8 | xargs -r rm -f\necho \"Old backups rotated (keeping 7 most recent)\"\nEOF",
      "Run command: `chmod +x mysql-backup.sh`",
      "AGENT: ''",
      "AGENT: '--- Approach 9: Execute SQL Script ---'",
      "Create tool: `cat > setup.sql << 'EOF'`",
      "CREATE DATABASE IF NOT EXISTS testdb;\nUSE testdb;\n\nCREATE TABLE IF NOT EXISTS products (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    price DECIMAL(10,2) NOT NULL,\n    stock INT DEFAULT 0\n);\n\nINSERT INTO products (name, price, stock) VALUES\n    ('Laptop', 999.99, 10),\n    ('Mouse', 29.99, 50),\n    ('Keyboard', 79.99, 30);\n\nSELECT * FROM products;\nEOF",
      "AGENT: ''",
      "Run command: `mysql -u root -p < setup.sql`",
      "AGENT: 'Executes all commands in script'",
      "AGENT: ''",
      "AGENT: '--- Approach 10: Useful MySQL Commands ---'",
      "AGENT: ''",
      "AGENT: 'Database info:'",
      "AGENT: 'mysql> SHOW DATABASES;'",
      "AGENT: 'mysql> SHOW TABLES;'",
      "AGENT: 'mysql> SHOW CREATE TABLE users;'",
      "AGENT: 'mysql> DESCRIBE users;'",
      "AGENT: ''",
      "AGENT: 'Status:'",
      "AGENT: 'mysql> STATUS;'",
      "AGENT: 'mysql> SHOW PROCESSLIST;  -- Active connections'",
      "AGENT: 'mysql> SHOW VARIABLES LIKE \\'max_connections\\';'",
      "AGENT: ''",
      "AGENT: 'Table operations:'",
      "AGENT: 'mysql> ALTER TABLE users ADD COLUMN age INT;'",
      "AGENT: 'mysql> DROP TABLE old_table;'",
      "AGENT: 'mysql> TRUNCATE TABLE logs;  -- Delete all rows'",
      "AGENT: ''",
      "AGENT: 'Indexes:'",
      "AGENT: 'mysql> CREATE INDEX idx_username ON users(username);'",
      "AGENT: 'mysql> SHOW INDEX FROM users;'",
      "AGENT: 'mysql> DROP INDEX idx_username ON users;'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Query Optimization ---'",
      "AGENT: ''",
      "AGENT: 'mysql> EXPLAIN SELECT * FROM users WHERE username = \\'alice\\';'",
      "AGENT: 'Shows query execution plan'",
      "AGENT: ''",
      "AGENT: 'mysql> SHOW FULL PROCESSLIST;'",
      "AGENT: 'Shows slow queries'",
      "AGENT: ''",
      "AGENT: '--- Bonus: MySQL Configuration ---'",
      "Run command: `sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf`",
      "AGENT: '[mysqld]'",
      "AGENT: 'max_connections = 200'",
      "AGENT: 'innodb_buffer_pool_size = 1G'",
      "AGENT: 'slow_query_log = 1'",
      "AGENT: 'slow_query_log_file = /var/log/mysql/slow.log'",
      "AGENT: ''",
      "Run command: `sudo systemctl restart mysql`",
      "AGENT: ''",
      "AGENT: '--- Bonus: MySQL CLI Tips ---'",
      "AGENT: ''",
      "AGENT: 'Save query results:'",
      "Run command: `mysql -u root -p myapp -e \"SELECT * FROM users;\" > users.txt`",
      "AGENT: ''",
      "AGENT: 'CSV export:'",
      "AGENT: 'mysql> SELECT * FROM users INTO OUTFILE \\'/tmp/users.csv\\''",
      "AGENT: '    -> FIELDS TERMINATED BY \\',\\' ENCLOSED BY \\'\"\\''",
      "AGENT: '    -> LINES TERMINATED BY \\'\\\\n\\';'",
      "AGENT: ''",
      "AGENT: 'Batch mode:'",
      "Run command: `mysql -u root -p --batch -e \"SELECT * FROM users;\" myapp`",
      "AGENT: 'Tab-separated output (good for scripting)'",
      "AGENT: ''",
      "AGENT: 'Silent mode:'",
      "Run command: `mysql -u root -p --silent myapp < query.sql`",
      "AGENT: ''",
      "AGENT: '‚úì SOLUTION SUMMARY:'",
      "AGENT: '  ‚úì Installed and secured MySQL server.'",
      "AGENT: '  ‚úì Connected with mysql -u username -p.'",
      "AGENT: '  ‚úì Created databases with CREATE DATABASE.'",
      "AGENT: '  ‚úì Created tables with proper schemas.'",
      "AGENT: '  ‚úì Inserted, selected, updated, and deleted data.'",
      "AGENT: '  ‚úì Managed users with CREATE USER and GRANT.'",
      "AGENT: '  ‚úì Executed SQL from command line with -e flag.'",
      "AGENT: '  ‚úì Backed up databases with mysqldump.'",
      "AGENT: '  ‚úì Imported SQL files with mysql < file.sql.'",
      "AGENT: '  ‚úì Created automated backup script.'",
      "AGENT: '  ‚úì You now master MySQL command-line operations! üóÑÔ∏è'"
    ],
    "commands": ["mysql", "mysqldump", "mysqlimport"],
    "packages": {
      "debian_ubuntu": ["mysql-server", "mysql-client"],
      "arch": ["mysql", "mariadb"]
    },
    "related_commands": ["psql", "sqlite3", "mongosh"],
    "complexity": "intermediate",
    "tags": ["mysql", "database", "sql", "queries", "backup", "mysqldump", "user-management", "cli", "administration"]
  }
]
