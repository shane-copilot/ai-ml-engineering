[
  {
    "id": "scenario_disk_usage_analysis_128",
    "command": "du",
    "scenario": "Analyze disk usage to find large files and directories consuming space.",
    "problem": "Disk is filling up, need to identify what's consuming space, find large directories, locate redundant files, analyze directory sizes hierarchically, and clean up disk space efficiently.",
    "solution": "Use du (disk usage) to analyze directory sizes, df for filesystem overview, ncdu for interactive analysis, find large files, sort by size, and identify space hogs for cleanup.",
    "steps": [
      "USER SAYS: 'My disk is almost full! How do I find what's taking up all the space and identify the largest directories and files?'",
      "AGENT: 'Let me show you disk usage analysis with du, df, and ncdu! We'll find space hogs, analyze directory sizes, and identify what to clean up.'",
      "AGENT: ''",
      "AGENT: '🔍 RESEARCH PHASE: Disk usage analysis...'",
      "AGENT: '[Searching] \"du df ncdu disk usage analysis find large files\"'",
      "AGENT: '[Found] df shows filesystem overview, du shows directory sizes.'",
      "AGENT: '[Found] du -h for human-readable, -s for summary, -c for total.'",
      "AGENT: '[Found] ncdu provides interactive disk usage explorer.'",
      "AGENT: '[Found] Combine du with sort to find largest directories.'",
      "AGENT: '✓ Research complete! Let's analyze disk usage.'",
      "AGENT: ''",
      "AGENT: '--- Approach 1: Check Filesystem Overview ---'",
      "Run command: `df -h`",
      "AGENT: 'Filesystem      Size  Used Avail Use% Mounted on'",
      "AGENT: '/dev/sda1        50G   42G  5.5G  89% /'",
      "AGENT: '/dev/sdb1       500G  380G  120G  76% /data'",
      "AGENT: 'tmpfs           7.8G  1.2M  7.8G   1% /tmp'",
      "AGENT: ''",
      "AGENT: '⚠️ Root partition at 89% - need to clean up!'",
      "AGENT: ''",
      "Run command: `df -i`",
      "AGENT: 'Filesystem      Inodes IUsed   IFree IUse% Mounted on'",
      "AGENT: '/dev/sda1      3276800 245892 3030908    8% /'",
      "AGENT: ''",
      "AGENT: 'Inode usage normal (8%) - not an inode exhaustion issue'",
      "AGENT: ''",
      "AGENT: '--- Approach 2: Basic Directory Size ---'",
      "Run command: `du -sh /var`",
      "AGENT: '15G     /var'",
      "AGENT: ''",
      "Run command: `du -sh /home`",
      "AGENT: '8.2G    /home'",
      "AGENT: ''",
      "Run command: `du -sh /usr`",
      "AGENT: '12G     /usr'",
      "AGENT: ''",
      "AGENT: '--- Approach 3: Top-Level Directory Analysis ---'",
      "Run command: `du -h --max-depth=1 / 2>/dev/null | sort -rh | head -20`",
      "AGENT: '42G     /'",
      "AGENT: '15G     /var'",
      "AGENT: '12G     /usr'",
      "AGENT: '8.2G    /home'",
      "AGENT: '3.1G    /opt'",
      "AGENT: '2.8G    /tmp'",
      "AGENT: '850M    /boot'",
      "AGENT: '120M    /etc'",
      "AGENT: '...'",
      "AGENT: ''",
      "AGENT: '💡 /var is largest - let's investigate!'",
      "AGENT: ''",
      "AGENT: '--- Approach 4: Drill Down into Large Directory ---'",
      "Run command: `du -h --max-depth=1 /var | sort -rh`",
      "AGENT: '15G     /var'",
      "AGENT: '8.5G    /var/log'",
      "AGENT: '4.2G    /var/lib'",
      "AGENT: '1.8G    /var/cache'",
      "AGENT: '450M    /var/tmp'",
      "AGENT: '...'",
      "AGENT: ''",
      "Run command: `du -h --max-depth=1 /var/log | sort -rh`",
      "AGENT: '8.5G    /var/log'",
      "AGENT: '5.2G    /var/log/journal'",
      "AGENT: '2.1G    /var/log/old-logs'",
      "AGENT: '890M    /var/log/nginx'",
      "AGENT: '320M    /var/log/syslog.1'",
      "AGENT: ''",
      "AGENT: '🎯 Found it! /var/log/journal using 5.2GB'",
      "AGENT: ''",
      "AGENT: '--- Approach 5: Find Largest Files ---'",
      "Run command: `find /var/log -type f -size +100M -exec ls -lh {} \\; | awk '{print $5, $9}'`",
      "AGENT: '1.2G /var/log/journal/abc123/system.journal'",
      "AGENT: '850M /var/log/old-logs/app.log.2024'",
      "AGENT: '320M /var/log/syslog.1'",
      "AGENT: '250M /var/log/nginx/access.log.1'",
      "AGENT: ''",
      "Run command: `find / -type f -size +1G 2>/dev/null -exec ls -lh {} \\; | awk '{print $5, $9}'`",
      "AGENT: '2.5G /home/user/downloads/ubuntu.iso'",
      "AGENT: '1.8G /var/lib/docker/overlay2/.../layer.tar'",
      "AGENT: '1.2G /var/log/journal/abc123/system.journal'",
      "AGENT: ''",
      "AGENT: '--- Approach 6: Analyze Specific Directory Tree ---'",
      "Run command: `du -ah /var/log | sort -rh | head -30`",
      "AGENT: '8.5G    /var/log'",
      "AGENT: '5.2G    /var/log/journal'",
      "AGENT: '2.1G    /var/log/old-logs'",
      "AGENT: '1.2G    /var/log/journal/abc123/system.journal'",
      "AGENT: '890M    /var/log/nginx'",
      "AGENT: '850M    /var/log/old-logs/app.log.2024'",
      "AGENT: '450M    /var/log/journal/abc123/user-1000.journal'",
      "AGENT: '320M    /var/log/syslog.1'",
      "AGENT: '...'",
      "AGENT: ''",
      "AGENT: '--- Approach 7: Interactive ncdu ---'",
      "Run command: `sudo apt install ncdu -y`",
      "Run command: `ncdu /var`",
      "AGENT: ''",
      "AGENT: 'ncdu provides interactive interface:'",
      "AGENT: '┌──────────────────────────────────────────────────┐'",
      "AGENT: '│ ncdu 1.17 ~ Use the arrow keys to navigate      │'",
      "AGENT: '├──────────────────────────────────────────────────┤'",
      "AGENT: '│   8.5 GB [##########] /log                       │'",
      "AGENT: '│   4.2 GB [#####     ] /lib                       │'",
      "AGENT: '│   1.8 GB [##        ] /cache                     │'",
      "AGENT: '│   450 MB [          ] /tmp                       │'",
      "AGENT: '└──────────────────────────────────────────────────┘'",
      "AGENT: ''",
      "AGENT: 'Navigation:'",
      "AGENT: '  • ↑/↓ arrows = Navigate'",
      "AGENT: '  • Enter = Drill into directory'",
      "AGENT: '  • d = Delete file/directory'",
      "AGENT: '  • q = Quit'",
      "AGENT: '  • ? = Help'",
      "AGENT: ''",
      "AGENT: '--- Approach 8: Find Old Files for Cleanup ---'",
      "Run command: `find /var/log -type f -mtime +30 -size +10M`",
      "AGENT: '/var/log/old-logs/app.log.2024'",
      "AGENT: '/var/log/nginx/access.log.2'",
      "AGENT: '/var/log/syslog.2.gz'",
      "AGENT: ''",
      "AGENT: 'Files older than 30 days and larger than 10MB'",
      "AGENT: ''",
      "Run command: `find /var/log -type f -mtime +30 -size +10M -exec du -h {} \\; | sort -rh`",
      "AGENT: '850M    /var/log/old-logs/app.log.2024'",
      "AGENT: '180M    /var/log/nginx/access.log.2'",
      "AGENT: '95M     /var/log/syslog.2.gz'",
      "AGENT: ''",
      "AGENT: '--- Approach 9: Disk Usage by User ---'",
      "Run command: `du -sh /home/* | sort -rh`",
      "AGENT: '3.2G    /home/alice'",
      "AGENT: '2.1G    /home/bob'",
      "AGENT: '1.8G    /home/charlie'",
      "AGENT: '1.1G    /home/diana'",
      "AGENT: ''",
      "Run command: `find /home -type f -printf '%s %u\\n' | awk '{user[$2]+=$1} END {for (u in user) printf \"%s: %.2f GB\\n\", u, user[u]/1024/1024/1024}' | sort -t: -k2 -rh`",
      "AGENT: 'alice: 3.20 GB'",
      "AGENT: 'bob: 2.10 GB'",
      "AGENT: 'charlie: 1.80 GB'",
      "AGENT: 'diana: 1.10 GB'",
      "AGENT: ''",
      "AGENT: '--- Approach 10: Package Cache Analysis ---'",
      "Run command: `du -sh /var/cache/apt/archives`",
      "AGENT: '1.2G    /var/cache/apt/archives'",
      "AGENT: ''",
      "Run command: `du -sh /var/lib/docker`",
      "AGENT: '8.5G    /var/lib/docker'",
      "AGENT: ''",
      "Run command: `docker system df`",
      "AGENT: 'TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE'",
      "AGENT: 'Images          25        5         6.2GB     4.8GB (77%)'",
      "AGENT: 'Containers      15        2         2.3GB     2.1GB (91%)'",
      "AGENT: 'Local Volumes   8         3         450MB     200MB (44%)'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Complete Disk Cleanup Script ---'",
      "Create tool: `cat > disk-cleanup.sh << 'EOF'`",
      "#!/bin/bash\nset -euo pipefail\n\necho \"=== Disk Space Analysis and Cleanup ===\"\necho \"\"\n\n# Current disk usage\necho \"Current disk usage:\"\ndf -h / | tail -1\necho \"\"\n\n# Find large directories\necho \"Top 10 largest directories:\"\ndu -h --max-depth=2 / 2>/dev/null | sort -rh | head -10\necho \"\"\n\n# Find large files\necho \"Largest files over 500MB:\"\nfind / -type f -size +500M 2>/dev/null -exec ls -lh {} \\; | awk '{print $5, $9}' | head -10\necho \"\"\n\n# Ask for confirmation\nread -p \"Proceed with cleanup? (y/n) \" -n 1 -r\necho\nif [[ ! $REPLY =~ ^[Yy]$ ]]; then\n    echo \"Cleanup cancelled\"\n    exit 0\nfi\n\necho \"Starting cleanup...\"\n\n# Clean package cache\necho \"Cleaning package cache...\"\nsudo apt clean\nsudo apt autoremove -y\n\n# Clean old logs\necho \"Cleaning old logs...\"\nsudo journalctl --vacuum-time=7d\nfind /var/log -type f -name \"*.log.*\" -mtime +30 -delete\nfind /var/log -type f -name \"*.gz\" -mtime +30 -delete\n\n# Clean thumbnail cache\necho \"Cleaning thumbnail cache...\"\nrm -rf ~/.cache/thumbnails/*\n\n# Clean temp files\necho \"Cleaning temp files...\"\nsudo rm -rf /tmp/*\nsudo rm -rf /var/tmp/*\n\n# Docker cleanup (if installed)\nif command -v docker &> /dev/null; then\n    echo \"Cleaning Docker...\"\n    docker system prune -af --volumes\nfi\n\necho \"\"\necho \"Cleanup complete!\"\necho \"New disk usage:\"\ndf -h / | tail -1\nEOF",
      "Run command: `chmod +x disk-cleanup.sh`",
      "AGENT: ''",
      "AGENT: '--- Bonus: Find Duplicate Files ---'",
      "Run command: `find /home -type f -exec md5sum {} + | sort | uniq -w32 -D --all-repeated=separate`",
      "AGENT: 'Lists duplicate files by comparing checksums'",
      "AGENT: ''",
      "AGENT: '--- Bonus: Disk Usage Visualization ---'",
      "Run command: `du -h /var/log | sort -rh | head -20 | awk '{printf \"%s\\t\", $1; for(i=0;i<$1*50/1000;i++) printf \"█\"; printf \" %s\\n\", $2}'`",
      "AGENT: 'Visual bar chart of directory sizes'",
      "AGENT: ''",
      "AGENT: '✓ SOLUTION SUMMARY:'",
      "AGENT: '  ✓ Checked filesystem overview with df -h.'",
      "AGENT: '  ✓ Analyzed directory sizes with du -h --max-depth.'",
      "AGENT: '  ✓ Found largest files with find and sort.'",
      "AGENT: '  ✓ Drilled down into large directories hierarchically.'",
      "AGENT: '  ✓ Used ncdu for interactive disk usage exploration.'",
      "AGENT: '  ✓ Identified old files for cleanup with find -mtime.'",
      "AGENT: '  ✓ Analyzed disk usage by user.'",
      "AGENT: '  ✓ Checked package cache and Docker space usage.'",
      "AGENT: '  ✓ Created automated cleanup script.'",
      "AGENT: '  ✓ You now master disk usage analysis and cleanup! 💾'"
    ],
    "commands": ["du", "df", "ncdu", "find", "sort", "awk", "md5sum"],
    "packages": {
      "debian_ubuntu": ["coreutils", "ncdu", "findutils"],
      "arch": ["coreutils", "ncdu", "findutils"]
    },
    "related_commands": ["df", "lsblk", "findmnt", "baobab"],
    "complexity": "intermediate",
    "tags": ["disk-usage", "du", "df", "ncdu", "storage", "cleanup", "analysis", "space-management"]
  }
]
